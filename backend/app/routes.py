from app import app
from lobby import lobby_util

@app.route('/')
def root():
    return "root page"

NO_SUCH_LOBBY_STRING = "No lobby"


@app.route('/create_lobby')
def create_lobby():
    return lobby_util.create_new_lobby()


@app.route('/<lobby_hash>')
@app.route('/<lobby_hash>/get')
def lobby_receive(lobby_hash):
    if lobby_hash in lobby_util.existing_lobbies:
        return lobby_util.existing_lobbies[lobby_hash]
    else:
        return NO_SUCH_LOBBY_STRING

@app.route('/<lobby_hash>/set_anime/<anime_id>',methods = ['PUT,''POST'])
def lobby_receive_set_anime(lobby_hash,anime_id):
    if lobby_hash in lobby_util.existing_lobbies:
        lobby_util.set_current_anime(lobby_hash, anime_id)
        return lobby_util.existing_lobbies[lobby_hash]
    else:
        return NO_SUCH_LOBBY_STRING

@app.route('/<lobby_hash>/add_user/<user_name>', methods = ['PUT,''POST'])
def lobby_add_user(lobby_hash,user_name):
    if lobby_hash in lobby_util.existing_lobbies:
        lobby_util.add_user(lobby_hash, user_name)
        return lobby_util.existing_lobbies[lobby_hash]
    else:
        return NO_SUCH_LOBBY_STRING