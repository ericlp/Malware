import string
import random
import time

from backend.kitsu_util.kitsu_util import *


def generate_lobby_id(length):
    all_char = string.ascii_letters + string.digits
    random.seed = time.process_time()
    lobby_id = ""
    for x in range(0, length):
        lobby_id = lobby_id + random.choice(all_char)
    return lobby_id


def generate_lobby_dictionary(lobby_id, anime_url, leader_id, *other_user_ids):
    lobby = {'id': lobby_id, 'anime': get_anime_dictionary_by_url(anime_url)}
    user_list = {}

    user_leader = get_user_dictionary_by_name_and_anime_url(leader_id, anime_url)
    user_leader['leader'] = True

    user_list['user0'] = user_leader

    user_num = 1
    for uid in other_user_ids:
        user_list['user' + str(user_num)] = get_user_dictionary_by_name_and_anime_url(uid, anime_url)

    lobby['userList'] = user_list

    return lobby
